import{d as c,o as r,a as e,l as A,r as _,m as v,x as R,s as Y,c as B,w as P,C as M,e as V,t as a,f as U,n as w,I as z}from"./app-C4Hj4rAK.js";const N={class:"min-h-screen bg-gray-50"},O={__name:"PublicLayout",setup(h){return(m,n)=>(r(),c("div",N,[e("main",null,[A(m.$slots,"default")])]))}},K={class:"w-full bg-primary text-white"},F=["dir"],I={key:0},J={key:1},Q={class:"text-sm"},W={key:0,class:"absolute right-0 mt-2 w-40 bg-white text-gray-800 rounded-md shadow-lg overflow-hidden z-50"},G=["dir"],H={class:"flex justify-end mb-3"},X={class:"text-sm text-gray-700"},Z={class:"font-medium"},ee={class:"relative bg-white border border-gray-200 rounded-2xl p-0 h-[100%]"},te={class:"flex justify-between"},se={class:"m-4"},ne={class:"inline-block px-3 py-1 text-xs rounded-md bg-rose-100 text-rose-700 border border-rose-200"},ae={class:"px-5 pt-6 pb-4"},oe={class:"flex items-center justify-between"},ie={class:"flex items-center gap-2"},le={class:"text-lg font-semibold text-gray-800"},re={class:"px-5 mt-4"},de={class:"text-md font-bold text-gray-500"},ce={class:"text-md font-bold text-gray-500"},ue={class:"text-gray-700 text-sm"},pe={class:"text-gray-700 text-sm"},me={class:"text-md font-bold text-gray-500"},ge={class:"text-md font-bold text-gray-500"},_e={class:"text-gray-700 text-sm"},xe={class:"text-gray-700 text-sm"},ve={class:"text-md font-bold text-gray-500"},he={class:"text-md font-bold text-gray-500"},fe={class:"text-gray-700 text-sm"},ye={class:"text-gray-700 text-sm"},be={class:"px-5 pb-6"},we={class:"rounded-xl overflow-hidden"},ke={class:"flex items-stretch justify-between bg-indigo-50"},Ce=["disabled"],Ee={class:"flex-1 px-4 py-3"},Le={class:"flex items-center justify-between"},Se={class:"text-md font-bold text-gray-800"},$e={class:"text-xs text-gray-500"},je={class:"mt-6 text-sm text-gray-600 flex items-center flex-wrap gap-x-3 gap-y-2"},Te={href:"#",class:"underline"},De={href:"#",class:"underline"},qe={class:"fixed inset-x-0 bottom-0 z-50 bg-white/90 backdrop-blur border-t"},Ae={class:"max-w-3xl mx-auto px-4 py-3"},Re=["disabled"],Ye={key:0},Be={key:1},Me={__name:"Show",props:{ticket:{type:Object,required:!0}},setup(h){const m=h,n=_(m.ticket),l=_("ar"),u=_(!1),f=v(()=>l.value==="ar"?"rtl":"ltr"),k={ar:{ticket_payment_status:"Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙØ¹",ticket_creation_date:"ØªØ§Ø±ÙŠØ® Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªØ°ÙƒØ±Ø©",ticket_details:"ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªØ°ÙƒØ±Ø©",phone:"Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ø§Ù„Ø¹Ù…ÙŠÙ„",name:"Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„",car_model:"Ø·Ø±Ø§Ø² Ø§Ù„Ø³ÙŠØ§Ø±Ø©",car_company:"Ø´Ø±ÙƒØ© Ø§Ù„Ø³ÙŠØ§Ø±Ø©",company:"Ø§Ù„Ø´Ø±ÙƒØ©",plate:"Ø±Ù‚Ù… Ø§Ù„Ù„ÙˆØ­Ø©",show_on_map:"Ø¹Ø±Ø¶ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©",branch_location:"Ù…ÙˆÙ‚Ø¹ Ø§Ù„ÙØ±Ø¹",terms:"Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù…",secure:"Ø¢Ù…Ù† ÙˆÙ…Ø­Ù…ÙŠ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„",platform:"Ù…Ù†ØµØ© ÙŠÙˆØ± ÙØ§Ù„ÙŠ",requesting:"Ø¬Ø§Ø±Ù Ø§Ù„Ø·Ù„Ø¨...",bring_car:"Ø£Ø­Ø¶Ø± Ø§Ù„Ø³ÙŠØ§Ø±Ø©"},en:{ticket_payment_status:"Status",ticket_creation_date:"Ticket creation date",ticket_details:"Ticket Details",phone:"Customer phone number",name:"Customer name",car_model:"Car model",car_company:"Car company",company:"The company",plate:"Car plate",show_on_map:"Show on map",branch_location:"Branch location",terms:"Terms and Conditions",secure:"Fully safe and secure",platform:"Your Valley platform",requesting:"Requesting...",bring_car:"Bring the car"}},o=s=>k[l.value][s]||s,C=()=>{u.value=!u.value},y=s=>{l.value=s,u.value=!1};v(()=>{const s="px-2 py-1 rounded-full text-xs font-medium";switch(m.ticket.status){case"pending":return`${s} bg-yellow-100 text-yellow-800`;case"in_progress":return`${s} bg-blue-100 text-blue-800`;case"ready":return`${s} bg-green-100 text-green-800`;case"delivered":return`${s} bg-gray-100 text-gray-800`;case"cancelled":return`${s} bg-red-100 text-red-800`;default:return`${s} bg-gray-100 text-gray-800`}});const E=s=>s.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "),S=s=>{const t=String(s||"").toLowerCase();return t==="pending"?"CAR PARKED":t==="in_progress"?"CAR REQUESTED":t==="ready"?"CAR READY BY EMPLOYEE":t==="delivered"?"CAR DELIVERED BY EMPLOYEE":t==="cancelled"||t==="canceled"?"CANCELLED":E(t).toUpperCase()},g=v(()=>{var s,t;return((s=n.value)==null?void 0:s.check_in_latitude)&&((t=n.value)==null?void 0:t.check_in_longitude)}),p=_(!1),$=()=>{if(!g.value)return;const s=L.map("map").setView([n.value.check_in_latitude,n.value.check_in_longitude],18);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"Â© OpenStreetMap contributors"}).addTo(s),L.marker([n.value.check_in_latitude,n.value.check_in_longitude]).addTo(s).bindPopup("Your vehicle is here").openPopup()},j=async()=>{if(!(p.value||n.value.status!=="pending")){p.value=!0;try{await z.post(route("api.tickets.request-vehicle",{ticket:n.value.id})),alert("Your vehicle is being prepared. Please wait at the pickup location."),n.value.status="in_progress"}catch(s){console.error("Error requesting vehicle:",s),alert("Failed to request your vehicle. Please try again or contact staff for assistance.")}finally{p.value=!1}}},T=s=>{if(!s)return"N/A";const t={year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"},i=l.value==="ar"?"ar-SA":void 0;return new Date(s).toLocaleString(i,t)};let d=null;const D=()=>{var t;if(!((t=n.value)!=null&&t.id)||!d)return null;const s=d.private(`ticket.${n.value.id}`);return s.listen("TicketStatusUpdated",i=>{var b;console.log("Ticket status updated:",i),((b=i.ticket)==null?void 0:b.id)===n.value.id&&(n.value.status=i.ticket.status,i.ticket.status==="ready"&&alert("Your vehicle is ready for pickup!"))}),s};let x=null;R(()=>{var s;x&&(x.stopListening("TicketStatusUpdated"),d&&d.leave(`ticket.${(s=n.value)==null?void 0:s.id}`))}),Y(()=>{const s=(t=0)=>{if(d=window.Echo,!d){t<10?setTimeout(()=>s(t+1),200):console.warn("Echo is not initialized after retries; skipping realtime setup.");return}x=D()};if(s(),g.value){const t=document.createElement("link");t.rel="stylesheet",t.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",document.head.appendChild(t);const i=document.createElement("script");i.src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",i.onload=()=>{window.L=L,$()},document.head.appendChild(i)}});const q=()=>{if(!g.value)return;const s=`https://www.google.com/maps/dir/?api=1&destination=${n.value.check_in_latitude},${n.value.check_in_longitude}`;typeof window<"u"&&window&&window.open?window.open(s,"_blank"):console.warn("Window is not available to open directions")};return(s,t)=>(r(),B(O,null,{default:P(()=>[e("div",K,[e("div",{class:"max-w-3xl mx-auto px-4 py-3 flex items-center justify-between",dir:f.value},[t[5]||(t[5]=e("div",{class:"flex items-center gap-2"},[e("img",{src:"/logo.jpg",class:"w-10 h-14"})],-1)),e("div",{class:"relative",onKeydown:t[2]||(t[2]=M(i=>u.value=!1,["escape"]))},[e("button",{onClick:C,class:"flex items-center gap-2 px-3 py-1.5 rounded-md bg-white/10 hover:bg-white/20 focus:outline-none"},[l.value==="ar"?(r(),c("span",I,"ðŸ‡¸ðŸ‡¦")):(r(),c("span",J,"ðŸ‡ºðŸ‡¸")),e("span",Q,a(l.value==="ar"?"Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©":"English"),1)]),u.value?(r(),c("div",W,[e("button",{onClick:t[0]||(t[0]=i=>y("ar")),class:"w-full text-right px-3 py-2 hover:bg-gray-50 flex items-center justify-between"},[...t[3]||(t[3]=[e("span",null,"Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",-1),e("span",null,"ðŸ‡¸ðŸ‡¦",-1)])]),e("button",{onClick:t[1]||(t[1]=i=>y("en")),class:"w-full text-right px-3 py-2 hover:bg-gray-50 flex items-center justify-between"},[...t[4]||(t[4]=[e("span",null,"English",-1),e("span",null,"ðŸ‡ºðŸ‡¸",-1)])])])):V("",!0)],32)],8,F)]),e("div",{class:"max-w-3xl mx-auto px-4 py-6 pb-28",dir:f.value},[e("div",H,[e("div",X,[U(a(o("ticket_creation_date"))+": ",1),e("span",Z,a(T(n.value.check_in_at)),1)])]),e("div",ee,[e("div",te,[e("div",se,[e("span",ne,a(S(n.value.status)),1)]),t[6]||(t[6]=e("div",{class:"m-4 w-6 h-1 rounded-full bg-green-400"},null,-1))]),e("div",ae,[e("div",oe,[e("div",ie,[t[7]||(t[7]=e("span",{class:"text-gray-500 text-lg"},"â€º",-1)),t[8]||(t[8]=e("span",{class:"text-gray-500 text-lg"},"#",-1)),e("h2",le,a(o("ticket_details")),1)]),t[9]||(t[9]=e("div",{class:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center ring-1 ring-gray-200"},[e("span",{class:"text-gray-400 text-lg"},"ðŸ“·")],-1))])]),t[12]||(t[12]=e("hr",{class:"mx-6"},null,-1)),e("div",re,[e("div",{class:w(["grid grid-cols-2 gap-y-3 gap-x-4",l.value==="ar"?"text-right":"text-left"])},[e("div",de,a(o("phone")),1),e("div",ce,a(o("name")),1),e("div",ue,a(n.value.customer_phone||"-"),1),e("div",pe,a(n.value.customer_name||"-"),1),e("div",me,a(o("car_model")),1),e("div",ge,a(o("car_company")),1),e("div",_e,a(n.value.vehicle_model||"-"),1),e("div",xe,a(n.value.vehicle_make||n.value.vehicle_company||"-"),1),e("div",ve,a(o("company")),1),e("div",he,a(o("plate")),1),e("div",fe,a(n.value.company||"-"),1),e("div",ye,a(n.value.license_plate||"-"),1)],2)]),t[13]||(t[13]=e("hr",{class:"m-6"},null,-1)),e("div",be,[e("div",we,[e("div",ke,[e("button",{type:"button",onClick:q,disabled:!g.value,class:w(["flex-1",l.value==="ar"?"text-right":"text-left","px-4","py-4","text-md","font-bold","text-indigo-900","hover:bg-indigo-100","focus:outline-none","disabled:opacity-50","disabled:cursor-not-allowed"])},a(o("show_on_map")),11,Ce),t[11]||(t[11]=e("div",{class:"w-px bg-indigo-100"},null,-1)),e("div",Ee,[e("div",Le,[e("div",null,[e("div",Se,a(o("branch_location")),1),e("div",$e,a(n.value.branch_name||"-"),1)]),t[10]||(t[10]=e("div",{class:"w-8 h-8 rounded-full bg-indigo-200/60 ring-1 ring-indigo-300 flex items-center justify-center"},[e("span",{class:"text-indigo-800 text-xl font-bold"},"â¬¡")],-1))])])])])])]),t[15]||(t[15]=e("div",{class:"mt-4"},[e("div",{class:"w-full h-12 rounded-xl bg-white border border-gray-200"})],-1)),e("div",je,[e("a",Te,a(o("terms")),1),e("a",De,a(o("secure")),1),e("span",null,a(o("platform")),1),t[14]||(t[14]=e("span",{class:"ml-auto"},[e("span",{class:"inline-flex items-center justify-center align-middle text-indigo-900"})],-1))]),e("div",qe,[e("div",Ae,[e("button",{onClick:j,disabled:p.value||n.value.status!="pending",class:"w-full h-14 rounded-xl bg-primary hover:bg-primary-dark text-white text-lg font-medium disabled:opacity-50 disabled:cursor-not-allowed"},[p.value?(r(),c("span",Ye,a(o("requesting")),1)):(r(),c("span",Be,a(o("bring_car")),1))],8,Re)])])],8,G)]),_:1}))}};export{Me as default};
